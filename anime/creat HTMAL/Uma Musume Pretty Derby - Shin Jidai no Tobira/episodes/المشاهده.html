<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uma Musume Pretty Derby - Shin Jidai no Tobira</title>
    <link rel="stylesheet" href="../../../CSS/episodes.css">
    <link rel="stylesheet" href="../../../CSS/style.css">
    <script src="../../../RS.js" defer></script>
    <script src="../../../navbar.js" defer></script>
    <link rel="icon" href="https://abdo838.github.io/1/navbar/favicon.ico" type="image/x-icon">
</head>

<body>

    <div id="navbar-container"></div>



    <!-- Content -->

    <div class="container">

        <main class="main-content">

            <div class="anime-info-header">

                <h2 id="anime-title">Uma Musume Pretty Derby - Shin Jidai no Tobira</h2>

                <p id="episode-title">رقم الحلقة: 1</p>

            </div>

            <div class="server-buttons" id="server-buttons-container"></div>

            <div class="video-container">

                <iframe id="video-player" src="" frameborder="0" allowfullscreen></iframe>

            </div>

            <div class="navigation-buttons">

                <button id="prev-btn">السابق</button>

                <button id="next-btn">التالي</button>

            </div>

        </main>

        

        <aside class="episodes">

            <h2>جميع الحلقات</h2>

            <ul id="episodes-list"></ul>

        </aside>

    </div>



    <script>

        let episodes = [];

        let currentEpisodeIndex = 0;

        let currentServerName = '';



        const episodesList = document.getElementById('episodes-list');

        const videoPlayer = document.getElementById('video-player');

        const animeTitle = document.getElementById('anime-title');

        const episodeTitle = document.getElementById('episode-title');

        const prevBtn = document.getElementById('prev-btn');

        const nextBtn = document.getElementById('next-btn');

        const serverButtonsContainer = document.getElementById('server-buttons-container');



        // استخراج معلمات URL

        function getQueryParam(param) {

            const urlParams = new URLSearchParams(window.location.search);

            return urlParams.get(param);

        }



        // تعيين الحلقة بناءً على معلمة URL

        function setEpisodeFromURL() {

            const episodeParam = getQueryParam('episode');

            if (episodeParam) {

                const episodeIndex = parseInt(episodeParam, 10) - 1; // الفهرس يبدأ من 0

                if (episodeIndex >= 0 && episodeIndex < episodes.length) {

                    playEpisode(episodeIndex);

                } else {

                    console.warn('رقم الحلقة غير صالح');

                }

            }

        }



        // تحميل البيانات من ملف JSON

        function loadEpisodesData() {

            fetch('../episodes.json')

                .then(response => response.json())

                .then(data => {

                    episodes = data;

                    loadEpisodes();

                    setEpisodeFromURL(); // تعيين الحلقة بناءً على الرابط

                })

                .catch(error => console.error('Error loading episodes data:', error));

        }



        // عرض قائمة الحلقات

// عرض قائمة الحلقات

function loadEpisodes() {

    episodesList.innerHTML = ''; // إفراغ القائمة السابقة

    episodes.forEach((episode, index) => {

        const li = document.createElement('li');

        li.className = 'episode-item';

        

        // تعيين عنوان الحلقة

        li.textContent = episode.title;



        // إضافة حدث عند الضغط على الحلقة

        li.addEventListener('click', () => {

            window.location.href = episode.link; // الانتقال إلى الرابط الموجود في JSON

        });



        episodesList.appendChild(li);

    });

}





        // عرض السيرفرات

        function loadServerButtons() {

            serverButtonsContainer.innerHTML = '';

            const currentEpisode = episodes[currentEpisodeIndex];



            currentEpisode.servers.forEach(server => {

                const button = document.createElement('button');

                button.textContent = server.serverName;

                button.classList.add('server-button');

                if (server.serverName === currentServerName) {

                    button.classList.add('active');

                }

                button.addEventListener('click', () => {

                    currentServerName = server.serverName;

                    videoPlayer.src = server.url;

                    loadServerButtons();

                });

                serverButtonsContainer.appendChild(button);

            });

        }



        // تحديث مشغل الفيديو

        function updatePlayer() {

            const currentEpisode = episodes[currentEpisodeIndex];

            animeTitle.textContent = "Uma Musume Pretty Derby - Shin Jidai no Tobira"; // يمكن تغييره ديناميكيًا

            episodeTitle.textContent = `رقم الحلقة: ${currentEpisode.number}`;



            if (!currentServerName && currentEpisode.servers.length > 0) {

                currentServerName = currentEpisode.servers[0].serverName;

            }



            const currentServer = currentEpisode.servers.find(server => server.serverName === currentServerName);

            if (currentServer) {

                videoPlayer.src = currentServer.url;

            } else {

                console.warn('لا يوجد سيرفر مناسب.');

            }



            loadServerButtons();

        }



        // تشغيل حلقة

        function playEpisode(index) {

            currentEpisodeIndex = index;

            currentServerName = '';

            updatePlayer();

        }



        // التنقل بين الحلقات

        function navigateEpisode(direction) {

            currentEpisodeIndex += direction;

            if (currentEpisodeIndex < 0) currentEpisodeIndex = 0;

            if (currentEpisodeIndex >= episodes.length) currentEpisodeIndex = episodes.length - 1;

            currentServerName = '';

            updatePlayer();

        }



        prevBtn.addEventListener('click', () => navigateEpisode(-1));

        nextBtn.addEventListener('click', () => navigateEpisode(1));



        // تحميل البيانات عند بدء الصفحة

        window.onload = loadEpisodesData;

    </script>



         <!-- تحميل الشريط العلوي من ملف -->

         <script>

            fetch('../../../navbar.html')

                .then(response => response.text())

                .then(data => document.getElementById('navbar-container').innerHTML = data);

        </script>

</body>

</html>

